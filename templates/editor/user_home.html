{% extends 'base.html' %}




{% block main %}
<div class="user-homepage">
  <div class="user-text">
    <h1>My <strong>WordNerd</strong> Crosswords</h1>

    <form id="new-puzzle-form" method="POST">
      Start a new puzzle with <input type="number" id="rowN" name="rowN" min="1" max="30" style="display: inline;"
        class="inp" value="15">
      <label for="rowN">rows</label>
      and <input type="number" id="colN" name="colN" min="1" max="30" style="display: inline;" class="inp" value="15">
      <label for="colN">columns.</label>
      <button type="submit" id="create-btn" class='btn'>Create</button>
    </form>
  </div>

  <div class="flex-box">
      <div id="draft-box">
        <!-- class="draft-search" automagically makes an input a search field. -->
        <input class="draft-search" placeholder="Search Draft Puzzles" />
        <!-- class="sort" automagically makes an element a sort buttons. The date-sort value decides what to sort by. -->
        <button class="sort" data-sort="puzzle.created_at">
          Sort
        </button>

      <!-- Child elements of container with class="list" becomes list items -->
      <h3>Draft Puzzles</h3>
      {% for puzzle in drafts %}
      <div>
        <a href="{% url 'edit' puzzle.pk %}">
        <!-- The innerHTML of children with class="puzzle-created-at" becomes this items "{{puzzle.created_at}}" value -->
          <div class="display-title">
          <!-- Child elements of container with class="list" becomes list items -->
          <ul class="list">
            <li>  <p class="puzzle.created_at">
              {% if puzzle.data.title %}
              {{ puzzle.data.title }}
              {% else %}
              My Puzzle
              {% endif %}
              started at: {{puzzle.created_at}}</p> </li>
          </ul>
          </div>
        </a>
      </div>
      {% endfor %}
    </div>

    <div class="completed-box">
      <h3>Completed Puzzles</h3>
      {% for puzzle in completes %}
      <div>
        <a href="">

            <p class="puzzle-title-display">
              {% if puzzle.data.title %}
              {{ puzzle.data.title }}
              {% else %}
              My Puzzle
              {% endif %}
              started at: {{puzzle.created_at}}
            </p>

        </a>
      </div>
      {% endfor %}
    </div>

    {% comment %} <div class="draft-box">
      <h3>Draft Puzzles</h3>
      {% for puzzle in drafts %}
      <div>
        <a href="{% url 'edit' puzzle.pk %}">
          <div class="display-title">
            <p class="puzzle-title-display">
              {% if puzzle.data.title %}
              {{ puzzle.data.title }}
              {% else %}
              My Puzzle
              {% endif %}
              started at: {{puzzle.created_at}}</p>
          </div>
        </a>
      </div>
      {% endfor %}
    </div>

    <div class="completed-box">
      <h3>Completed Puzzles</h3>
      {% for puzzle in completes %}
      <div>
        <a href="">

            <p class="puzzle-title-display">
              {% if puzzle.data.title %}
              {{ puzzle.data.title }}
              {% else %}
              My Puzzle
              {% endif %}
              started at: {{puzzle.created_at}}
            </p>

        </a>
      </div>
      {% endfor %}
    </div> {% endcomment %}
  </div>


</div>

<script>
  document.querySelector('#new-puzzle-form').addEventListener('submit', (event) => {
    event.preventDefault()
    const rowN = document.querySelector('#rowN').value
    const colN = document.querySelector('#colN').value
    return fetch(`/new/`, {
      method: 'POST',
      headers: {
        'Content-type': 'application/json'
      },
      body: JSON.stringify({ rowN, colN })
    })
      .then(resp => resp.json())
      .then(data => {
        console.log(data.pk)
        window.location.href = `/edit/${data.pk}`
      })
  })
</script>

{% endblock main %}
